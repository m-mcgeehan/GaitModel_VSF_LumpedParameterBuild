%% Markers
%Align coordinate systems (simscape wrt v3d: x = y, y = -x, z = z)
x = [0 1 0;...
    -1 0 0;...
    0 0 1];

%Format markers
LASIavg = (x*(mean(LASI{1}(:,1:3))')*100); %Pelvis
RASIavg = (x*(mean(RASI{1}(:,1:3))')*100);
LPSIavg = (x*(mean(LPSI{1}(:,1:3))')*100);
RPSIavg = (x*(mean(RPSI{1}(:,1:3))')*100);
HJCRavg = x*(mean(FHipL_landmark)');
HJCRavg = x*(mean(FHipR_landmark)'); clear LASI RASI LPSI RPSI FHipL_landmark FHipR_landmark

RLEPavg = (x*(mean(RLEP{1}(:,1:3))')*100); %Leg
LLEPavg = (x*(mean(LLEP{1}(:,1:3))')*100); 
RMEPavg = (x*(mean(RMEP{1}(:,1:3))')*100); 
LMEPavg = (x*(mean(LMEP{1}(:,1:3))')*100); clear RLEP LLEP RMEP LMEP
KJCLavg = x*(mean(FKneeL_landmark)');
KJCRavg = x*(mean(FKneeR_landmark)'); clear LASI RASI LPSI RPSI FHipL_landmark FHipR_landmark

RLEPavg = (x*(mean(RLEP{1}(:,1:3))')*100); %Shank


LHCEavg = (x*(mean(LHCE{1}(:,1:3))')*100);
RHCEavg = (x*(mean(RHCE{1}(:,1:3))')*100);
LHLAavg = (x*(mean(LHLA{1}(:,1:3))')*100);
RHLAavg = (x*(mean(RHLA{1}(:,1:3))')*100);
LHMEavg = (x*(mean(LHME{1}(:,1:3))')*100);
RHMEavg = (x*(mean(RHME{1}(:,1:3))')*100);
LLEPavg = (x*(mean(LLEP{1}(:,1:3))')*100);
RLEPavg = (x*(mean(RLEP{1}(:,1:3))')*100);
LMEPavg = (x*(mean(LMEP{1}(:,1:3))')*100);
RMEPavg = (x*(mean(RMEP{1}(:,1:3))')*100);

LTCEavg = (x*(mean(LTCE{1}(:,1:3))')*100);
RTCEavg = (x*(mean(RTCE{1}(:,1:3))')*100);
LTLAavg = (x*(mean(LTLA{1}(:,1:3))')*100);
RTLAavg = (x*(mean(RTLA{1}(:,1:3))')*100);
LTMEavg = (x*(mean(LTME{1}(:,1:3))')*100);
RTMEavg = (x*(mean(RTME{1}(:,1:3))')*100);
LSK1avg = (x*(mean(LSK1{1}(:,1:3))')*100);
LSK2avg = (x*(mean(LSK2{1}(:,1:3))')*100);
LSK3avg = (x*(mean(LSK3{1}(:,1:3))')*100);
LSK4avg = (x*(mean(LSK4{1}(:,1:3))')*100);


%% Pelvis
LASI = LASI{1};
RASI = RASI{1};
LPSI = LPSI{1};
RPSI = RPSI{1};
PelvisO = ((RASI-LASI) - (RPSI - LPSI));
